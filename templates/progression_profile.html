{% extends "base.html" %}

{% block header %}
	<li class="nav-item">
		<a class="nav-link" href="{{ url_for('main.index') }}">Home</a>
	</li>
	<li class="nav-item">
		<a class="nav-link" href="{{ url_for('auth.login') }}">Login</a>
	</li>
	<li class="nav-item">
		<a class="nav-link" href="{{ url_for('auth.signup') }}">Sign Up</a>
	</li>
	<li class="nav-item">
		<a class="nav-link" href="{{ url_for('main.profile') }}">Profile</a>
	</li>
	<li class="nav-item">
		<a class="nav-link active" aria-current="page" href="{{ url_for('main.progression') }}">Progression Dashboard</a>
	</li>
	<li class="nav-item">
		<a class="nav-link" href="{{ url_for('auth.logout') }}">Logout</a>
	</li>
{% endblock %}

{% block body %}
<h1 class="title">
	Welcome, {{ current_user.name }}!
</h1>

<br>

<h2 class="title">Enter Alzheimer's Progression Information for Your Patient Here:</h2>
<table id="progressionInput" class="table">
	<tr>
		<th>Age</th>
		<th>Months Since First Observation</th>
		<th>ADAS-13 Measurement</th>
	</tr>
	<tr>
		<td contenteditable="true"></td>
		<td contenteditable="true"></td>
		<td contenteditable="true"></td>
	</tr>
</table>
<br>
<div class="row">
	<div class="col-sm-12">
		<button id="addRowButton" class="btn btn-dark">Add Progression Information</button>
		<button id="submitButton" class="btn btn-dark">Submit Data</button>
	</div>
</div>
	
{% raw %}
<script>
	document.getElementById('addRowButton').addEventListener('click', function() {
			var table = document.getElementById('progressionInput');
			console.log(table);
			var row = table.insertRow(-1);
			var cell1 = row.insertCell(0);
			var cell2 = row.insertCell(1);
			var cell3 = row.insertCell(2);
			cell1.setAttribute('contenteditable', 'true');
			cell2.setAttribute('contenteditable', 'true');
			cell3.setAttribute('contenteditable', 'true');
		});
	document.getElementById('submitButton').addEventListener('click', function() {
			// Retrieve data from the table
    			var table = document.getElementById("my-table");
			var rows = table.rows;
    			var data = [];
    			for (var i = 0; i < rows.length; i++) {
      				var cells = rows[i].cells;
      				var rowData = [];
      				for (var j = 0; j < cells.length; j++) {
        				rowData.push(cells[j].textContent);
      				}
      				data.push(rowData);
    			}
			
			fetch('https://159.203.187.54/pred', {
					method: 'POST',
					body: JSON.stringify(data),
					headers: {
					   'Content-Type': 'application/json'
						}
				}).then((result) => {
					console.log(result);
				});
		}
			
</script>
{% endraw %}

<p> {{ console }} </p>
{% endblock %}
